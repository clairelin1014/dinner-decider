<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ™šé¤åƒä»€éº¼ï¼Ÿ(éŠ…æ¿ç¾é£Ÿ)</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* --- ä½åƒ¹ä½ç¾å­¸ï¼šé–‹èƒƒæš–è‰²èª¿ã€æ™®æ™®é¢¨ --- */
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f1c40f;
            background-image: radial-gradient(#d35400 15%, transparent 16%),
                              radial-gradient(#d35400 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
            -webkit-user-select: none;
            user-select: none;
        }
        .container {
            background: #fff;
            padding: 2.5rem 2rem;
            border: 4px solid #2c3e50;
            border-radius: 15px;
            box-shadow: 10px 10px 0px #2c3e50;
            width: 85%;
            max-width: 380px;
            text-align: center;
            position: relative; /* ç‚ºäº†æˆªåœ–å®šä½ */
        }
        h1 {
            color: #2c3e50;
            margin: 0 0 10px 0;
            font-size: 1.8rem;
            font-weight: 900;
            text-shadow: 2px 2px 0px #f1c40f; 
            letter-spacing: -1px;
        }
        .subtitle {
            background-color: #e74c3c;
            color: #fff;
            font-size: 1rem;
            padding: 5px 15px;
            border: 2px solid #2c3e50;
            border-radius: 50px;
            display: inline-block;
            margin-bottom: 2rem;
            font-weight: bold;
            box-shadow: 3px 3px 0px #2c3e50;
        }
        .result-box-container {
            height: 140px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2.5rem;
            border: 4px solid #2c3e50;
            border-radius: 10px;
            background: #ff6b35; 
            overflow: hidden;
            position: relative;
        }
        .result-content {
            font-size: 2.2rem;
            font-weight: 900;
            color: #fff;
            text-shadow: 3px 3px 0px #2c3e50;
            width: 100%;
            position: absolute;
            z-index: 2;
            padding: 0 10px;
            word-break: keep-all;
        }
        .result-box-container::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: repeating-linear-gradient(
                45deg,
                rgba(255,255,255,0.1),
                rgba(255,255,255,0.1) 10px,
                transparent 10px,
                transparent 20px
            );
            z-index: 1;
        }
        .blur-effect {
            filter: blur(4px);
            transform: scale(1.1) skew(-5deg);
        }
        
        /* æŒ‰éˆ•ç¾¤çµ„å®¹å™¨ */
        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        button {
            cursor: pointer;
            border: 4px solid #2c3e50;
            padding: 18px 0;
            border-radius: 12px;
            font-weight: 900;
            font-size: 1.3rem;
            width: 100%;
            box-shadow: 6px 6px 0px #2c3e50;
            transition: all 0.1s;
            position: relative; /* ç‚ºäº†æŒ‰å£“æ•ˆæœ */
        }
        button:active {
            top: 4px; left: 4px;
            box-shadow: 2px 2px 0px #2c3e50;
        }
        button:disabled {
            background: #ddd; color: #888;
            box-shadow: none; cursor: not-allowed;
            top: 6px; left: 6px;
        }

        /* ä¸»æŒ‰éˆ• (ç™½è‰²) */
        .btn-decide {
            background: #fff;
            color: #2c3e50;
        }
        .btn-decide:hover {
            background-color: #ffeaa7; /* æ·ºé»ƒè‰² hover */
        }

        /* åˆ†äº«æŒ‰éˆ• (è¨­è¨ˆæˆäº®è—è‰²æ’è‰²é¢¨æ ¼) */
        .btn-share {
            background: #54a0ff; /* äº®è—è‰² */
            color: #fff;
            display: none; /* é è¨­éš±è— */
        }
        .btn-share:hover {
            background-color: #2e86de;
        }

        .footer {
            margin-top: 30px;
            font-size: 0.9rem;
            font-weight: bold;
            color: #2c3e50;
            background: #f1c40f;
            padding: 5px;
            border: 2px solid #2c3e50;
            transform: rotate(-2deg);
            display: inline-block;
        }

        /* æˆªåœ–æ™‚çš„æ¨£å¼èª¿æ•´ */
        .taking-screenshot .btn-group,
        .taking-screenshot .footer {
            display: none !important;
        }
        .taking-screenshot.container {
            box-shadow: none;
            /* ä¿æŒé‚Šæ¡†ï¼Œå› ç‚ºé€™ä¹Ÿæ˜¯é¢¨æ ¼çš„ä¸€éƒ¨åˆ† */
            border: 4px solid #2c3e50;
            padding-bottom: 2.5rem;
        }
    </style>
</head>
<body>

<div class="container" id="captureArea">
    <h1>è€å…¬ï¼Œä»Šæ™šåƒä»€éº¼ï¼Ÿ</h1>
    <div class="subtitle">ğŸ’¸ æœˆåº•æ•‘æ˜Ÿ / éš¨ä¾¿åƒåƒ</div>
    
    <div class="result-box-container">
        <div class="result-content" id="resultDisplay">é¤“äº†å—ï¼Ÿ</div>
    </div>

    <div class="btn-group">
        <button class="btn-decide" onclick="pickFood()">éŠ…æ¿ç¾é£Ÿè½‰èµ·ä¾†ï¼ğŸ°</button>
        <button class="btn-share" id="shareButton" onclick="shareScreenshot()">ğŸ“¤ åˆ†äº«æˆªåœ–</button>
    </div>
    
    <div class="footer">è€å©†ç‰¹è£½ï¼šçœéŒ¢ä¹Ÿæ˜¯ä¸€ç¨®æ„› â¤ï¸</div>
</div>

<script>
    const foods = [
        'æ—è¨˜æµ·å—é›é£¯',
        'é¬é¬šå¼µé­¯è‚‰é£¯', 'æ‚Ÿé¥•æ± ä¸Šé£¯åŒ…', 'ä¸‰å•†å·§ç¦', 
        'æ¢ç¤¾æ¼¢æ’éª¨', 'ã™ãå®¶ (Sukiya)', 'å‰é‡å®¶', 
         'ç‡’è‚‰é£¯', 'é›è‚‰é£¯', 'å··å£è‡ªåŠ©é¤',
        'å…«æ–¹é›²é›†', 'å››æµ·éŠé¾', 'æº«å·å¤§é¤›é£©', 
        'ç‰›è‚‰éºµ', 'å··å£ä¹¾éºµ + æ»·å‘³', 'ç‚¸é†¬éºµ', 
        'è€é¥•éºµé¤¨',
        'éº¥ç•¶å‹', 'è‚¯å¾·åŸº', 'æ‘©æ–¯æ¼¢å ¡', 
        'å¿…å‹å®¢', 'èƒ–è€çˆ¹', 'æ¼¢å ¡ç‹',
        'å¤œå¸‚ç‰›æ’', 'é¹¹é…¥é› + å•¤é…’', 'æ»·å‘³', 
        'èšµä»”ç…', 'è‡­è±†è…', 'æ½¤é¤…', 
        '7-11 å¾®æ³¢ä¾¿ç•¶', 'å…¨å®¶ å‹å–„æ™‚å…‰', 
        'æ³¡éºµ + åŠ è›‹', 'Subway', 
        'çˆ­é®®å¤–å¸¶å£½å¸', 'è·¯æ˜“è (è¼•é£Ÿ)'
    ];

    let timer = null;
    const shareBtn = document.getElementById('shareButton');
    const displayContent = document.getElementById('resultDisplay');
    const decideBtn = document.querySelector('.btn-decide');

    function pickFood() {
        if(timer) return;
        
        shareBtn.style.display = 'none';

        let counter = 0;
        const maxRounds = 30;

        decideBtn.disabled = true;
        decideBtn.innerText = "æœå°‹ä¾¿å®œå¥½æ–™...";
        displayContent.classList.add('blur-effect');

        timer = setInterval(() => {
            const randomIndex = Math.floor(Math.random() * foods.length);
            displayContent.innerText = foods[randomIndex];
            counter++;

            if (counter > maxRounds) {
                clearInterval(timer);
                timer = null;
                displayContent.classList.remove('blur-effect');
                btnReset();
                
                const finalIndex = Math.floor(Math.random() * foods.length);
                displayContent.innerHTML = `${foods[finalIndex]}`;
                
                // å‹•ç•«æ•ˆæœ
                displayContent.style.transform = "scale(1.3) rotate(5deg)";
                setTimeout(() => displayContent.style.transform = "scale(1) rotate(0deg)", 200);
            }
        }, 30);
    }

    function btnReset() {
        decideBtn.disabled = false;
        decideBtn.innerText = "ä¸å–œæ­¡ï¼Ÿå†è½‰ï¼";
        shareBtn.style.display = 'block'; // é¡¯ç¤ºåˆ†äº«æŒ‰éˆ•
    }

    // æˆªåœ–åŠŸèƒ½
    async function shareScreenshot() {
        const container = document.getElementById('captureArea');
        container.classList.add('taking-screenshot');

        try {
            const canvas = await html2canvas(container, {
                scale: 2, 
                backgroundColor: "#ffffff", 
                logging: false
            });

            canvas.toBlob(async (blob) => {
                const file = new File([blob], 'dinner-result.png', { type: 'image/png' });

                if (navigator.share && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        files: [file],
                        title: 'ä»Šæ™šåƒä¾¿å®œçš„ï¼',
                        text: `çœéŒ¢å¤§ä½œæˆ°ï¼Œä»Šæ™šåƒï¼š${displayContent.innerText}ï¼`
                    });
                } else {
                    alert('ç€è¦½å™¨ä¸æ”¯æ´ç›´æ¥åˆ†äº«ï¼Œè«‹é•·æŒ‰å„²å­˜ï¼');
                }
            }, 'image/png');

        } catch (error) {
            console.error('æˆªåœ–å¤±æ•—:', error);
        } finally {
            container.classList.remove('taking-screenshot');
        }
    }
</script>
</body>
</html>
